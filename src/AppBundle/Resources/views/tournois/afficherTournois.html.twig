{% extends 'AppBundle::base.html.twig' %}

{% block body %}
    <h1>Espace joueur: {{ user.userPrenom }}</h1>


    <div class="container">
    <h2>Tournois {{ tournois.tournoisNom }}</h2>
    <br>


    {% if isComplet == true %}
        <h3>{{ nbParticipants }}/{{ tournois.tournoisNombreJoueurs }} Le tournoi est complet</h3>
    {% else %}
        <h3>{{ nbParticipants }}/{{ tournois.tournoisNombreJoueurs }}</h3>
    {% endif %}
    {% if participe == true %}
        <p>Je participe au tournoi</p>
    {% endif %}
    {% if isComplet == false and participe == false and isComplet == false %}
        <form action="" method="post">
            <input type="submit" name="participer" value="Participer au tournoi">
        </form>
    {% elseif participe == true and isComplet == false %}
        <form action="" method="post">
            <input type="submit" name="quitter" value="Quitter le tournoi">
        </form>

    {% endif %}

    {% if isComplet == true %}

        {% if partieFinie == true %}
            <h4>le tournoi est fini</h4>

            <h5>le gagnant est {{ victoire.username }}</h5>
            {% if participe == true %}
                <p><a href="{{ path('historique_tournoi', {'id':tournois.id} ) }}">Voir le tournois dans l'historique</a></p>
            {% endif %}

        {% else %}
            <h4>le tournoi a commenc√©</h4>
        {% endif %}


        {#{{ dump(match) }}#}
        {#{{ dump(parties) }}#}
        {#{{ dump(bloc) }}#}

        {% for key, partie in bloc %}
            <h3>Manche {{ loop.index }}</h3>
            {% for key, partie in partie  %}
                {% if key == 0 %}
                    {% else %}
                        {% if partie.joueur1 == null or partie.joueur2 == null %}
                            <h4>La partie n'a pas encore de joueurs</h4>
                            {% else %}
                                <h4>Partie {{ loop.index-1 }} entre {{ partie.joueur1.username }} et {{ partie.joueur2.username }}</h4>
                                <p><a href="{{ path('afficher_tounois_partie', {'idTourois':tournois.id,'id':partie.id} ) }}">voir le match</a></p>
                        {% endif %}

                {% endif %}

            {% endfor %}
        {% endfor %}
    {% endif %}

    <br>
    <h4>Liste des participants</h4>
    {% for joueur in tournois.getUsers %}
        <p>{{ joueur.username }}</p>

    {% else %}
        <p>Aucun participant sur ce tournois</p>
    {% endfor %}


    {% if app.session.flashBag.has('success') %}
        <div class="alert alert-success">
            {% for msg in app.session.flashBag.get('success') %}
                {{ msg }}
            {% endfor %}
        </div>
    {% endif %}


    <a href="{{ path('afficher_liste_tournois') }}"> <button>Retour</button></a>
{% endblock %}